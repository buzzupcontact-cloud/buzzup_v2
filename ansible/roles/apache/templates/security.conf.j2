# Security configuration for Apache

# Disable server signature
ServerTokens {{ apache_server_tokens }}
ServerSignature {{ apache_server_signature }}

# Disable access to .htaccess and other sensitive files
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# Disable access to backup and source files
<FilesMatch "(\.(bak|config|dist|fla|inc|ini|log|psd|sh|sql|swp)|~)$">
    Require all denied
</FilesMatch>

# Disable directory browsing
Options -Indexes

# Disable server-side includes and CGI execution
Options -Includes -ExecCGI

# Disable trace method
TraceEnable off

# Prevent access to PHP configuration files
<FilesMatch "\.php$">
    <If "%{REQUEST_URI} =~ m#/(config|configuration)\.php$#">
        Require all denied
    </If>
</FilesMatch>

# Security headers
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# Content Security Policy (adjust as needed)
Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self'; frame-src 'none';"

# Prevent clickjacking
Header always append X-Frame-Options SAMEORIGIN

# MIME type sniffing protection
Header always set X-Content-Type-Options nosniff

# Referrer policy
Header always set Referrer-Policy "strict-origin-when-cross-origin"